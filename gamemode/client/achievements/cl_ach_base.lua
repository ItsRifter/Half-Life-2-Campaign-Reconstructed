Lobby_Ach_List = {
	[1] = {name = "First_Time", desc = "Play the gamemode\nfor the first time", mat = "vgui/achievements/hl2_beat_cemetery.png", isRare = false},
	[2] = {name = "Worthless_Secret", desc = "You get this one\nbut with no XP!", mat = "entities/npc_kleiner.png", isRare = true},
	[3] = {name = "Lost_Cause", desc = "Find what remains of\nLeiftiger's HL2C server", mat = "vgui/achievements/hl2_beat_cemetery.png", isRare = false}
}

HL2_Ach_List = {
	[1] = {name = "A_Red_Letter_Baby", desc = "Bring the baby\ndoll to Dr.Kleiner", mat = "vgui/achievements/hl2_beat_game.png", isRare = false},
	[2] = {name = "What_cat", desc = "Break the mini-teleporter\nin Kleiner's lab", mat = "vgui/achievements/hl2_break_miniteleporter.png", isRare = false},
	[3] = {name = "Trusty_Hardware", desc = "Acquire the crowbar", mat = "vgui/achievements/hl2_get_crowbar.png", isRare = false},
	[4] = {name = "ZeroPoint_Energy", desc = "Acquire the Gravity gun\nin Black Mesa East", mat = "vgui/achievements/hl2_get_gravitygun.png", isRare = false},
	[5] = {name = "Rave_Ball", desc = "Carry dog's ball through\nRavenholm\ninto the mines", mat = "vgui/achievements/hl2_get_gravitygun.png", isRare = false},
	[6] = {name = "Keep_off_the_sand", desc = "Cross the antlion beach\nin d2_coast_11 without\ntouching the sand", mat = "vgui/achievements/hl2_beat_donttouchsand.png", isRare = false},
	[7] = {name = "Singularity_Collapse", desc = "Destroy the Citadel's reactor core", mat = "vgui/achievements/hl2_beat_game.png", isRare = false},
	[8] = {name = "Lambda Locator", desc = "Locate all the Lambda cache's", mat = "vgui/achievements/hl2_find_alllambdas.png", isRare = true},
}

Misc_Ach_List = {
	[1] = {name = "A_Predictable_Failure", desc = "Fail a map on survival with 4 or more players", mat = "vgui/achievements/hl2_find_allgmen.png", isRare = false},
	[2] = {name = "Blast_that_little", desc = "Complete the Zombie evolution tree", mat = "vgui/achievements/hl2_beat_toxictunnel.png", isRare = false},
	[3] = {name = "Born_Survivor", desc = "Finish five maps without dying", mat = "vgui/achievements/hl2_followfreeman", isRare = false},
}

HL2_Lambda_List = {
	[1] = {name = "d1_trainstation_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[2] = {name = "d1_canals_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[3] = {name = "d1_canals_01a", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[4] = {name = "d1_canals_02", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[5] = {name = "d1_canals_03", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[6] = {name = "d1_canals_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[7] = {name = "d1_canals_06", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[8] = {name = "d1_canals_07", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[9] = {name = "d1_canals_08", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[10] = {name = "d1_canals_09", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[11] = {name = "d1_canals_10", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[12] = {name = "d1_canals_12", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[13] = {name = "d1_eli_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[14] = {name = "d1_town_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[15] = {name = "d1_town_01a", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[16] = {name = "d1_town_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[17] = {name = "d2_coast_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[18] = {name = "d2_coast_03", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[19] = {name = "d2_coast_04", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[20] = {name = "d2_coast_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[21] = {name = "d2_coast_07", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[22] = {name = "d2_coast_09", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[23] = {name = "d2_coast_11", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[24] = {name = "d2_prison_02", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[25] = {name = "d2_prison_03", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[26] = {name = "d2_prison_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[27] = {name = "d2_prison_06", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[28] = {name = "d3_c17_02", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[29] = {name = "d3_c17_04", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[30] = {name = "d3_c17_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[31] = {name = "d3_c17_06a", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[32] = {name = "d3_c17_06b", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[33] = {name = "d3_c17_08", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	[34] = {name = "d3_c17_12b", mat = "vgui/achievements/hl2_find_alllambdas.png"},
}

HL2_Vortex_List = {
	[1] = {name = "d1_trainstation_05", mat = "vgui/achievements/hlx_find_onegman.png"},
	[2] = {name = "d1_trainstation_06", mat = "vgui/achievements/hlx_find_onegman.png"},
	[3] = {name = "d1_canals_01", mat = "vgui/achievements/hlx_find_onegman.png"},
	[4] = {name = "d1_canals_02", mat = "vgui/achievements/hlx_find_onegman.png"},
	[5] = {name = "d1_canals_05", mat = "vgui/achievements/hlx_find_onegman.png"},
	[6] = {name = "d1_eli_01", mat = "vgui/achievements/hlx_find_onegman.png"},
	[7] = {name = "d1_eli_02", mat = "vgui/achievements/hlx_find_onegman.png"},
	[8] = {name = "d1_town_02", mat = "vgui/achievements/hlx_find_onegman.png"},
	[9] = {name = "d1_town_03", mat = "vgui/achievements/hlx_find_onegman.png"},
	[10] = {name = "d1_town_02a", mat = "vgui/achievements/hlx_find_onegman.png"},
	[11] = {name = "d1_town_04", mat = "vgui/achievements/hlx_find_onegman.png"},
	[12] = {name = "d1_town_05", mat = "vgui/achievements/hlx_find_onegman.png"},
	[13] = {name = "d2_coast_01", mat = "vgui/achievements/hlx_find_onegman.png"},
}

function AchievementMenu(achievement, vortexes, lambdas)

	local achFrame = vgui.Create("DFrame")
	achFrame:SetSize(850, 600)
	achFrame:Center()
	achFrame:SetDraggable(false)
	achFrame:ShowCloseButton(true)
	achFrame:SetTitle("Achievements Menu")
	achFrame:MakePopup()
	
	local TabAchSheet = vgui.Create( "DPropertySheet", achFrame )
	TabAchSheet:Dock( FILL )
	
	local PanelLobbyAch = vgui.Create( "DPanel", achFrame )
	PanelLobbyAch:SetSize(800, 850)
	PanelLobbyAch:SetPos(0, 400)
	PanelLobbyAch.Paint = function(s, w, h)
		draw.RoundedBox(0,0,0, w, h, Color(170, 170, 170, 255))
	end
	
	local ScrollLobbyAch = vgui.Create("DScrollPanel", PanelLobbyAch)
	ScrollLobbyAch:Dock(FILL)
	
	local iconListLobby = vgui.Create("DIconLayout", ScrollLobbyAch)
	iconListLobby:Dock(FILL)
	iconListLobby:SetSpaceY(5)
	iconListLobby:SetSpaceX(5)
	
	for i = 1, #Lobby_Ach_List do
		
		local lobbyPanel = iconListLobby:Add("DPanel")
		lobbyPanel:SetPaintBackground(false)
		lobbyPanel:SetSize(128, 128)
		
		local achLobbyName = lobbyPanel:Add("DLabel")
		achLobbyName:SetPos(0, 65)
		--Find if the player has this achievement, if so show it with name, desc and icon
		if table.HasValue(achievement, Lobby_Ach_List[i].name) then
			achLobbyName:SetText(Lobby_Ach_List[i].name)
		else
			achLobbyName:SetText("LOCKED")
		end
		achLobbyName:SizeToContents()
		achLobbyName:SetColor(Color(0, 0, 0))
		
		local achLobbyDesc = lobbyPanel:Add("DLabel")
		achLobbyDesc:SetPos(0, 90)
		if table.HasValue(achievement, Lobby_Ach_List[i].name) then
			achLobbyDesc:SetText(Lobby_Ach_List[i].desc)
		else
			achLobbyDesc:SetText("???")
		end
		achLobbyDesc:SizeToContents()
		achLobbyDesc:SetColor(Color(0, 0, 0))
		
		local achLobbyIcon = lobbyPanel:Add("DImage")
		achLobbyIcon:SetPos(0, 0)
		achLobbyIcon:SetSize(64, 64)
		
		if table.HasValue(achievement, Lobby_Ach_List[i].name) then
			achLobbyIcon:SetImage(Lobby_Ach_List[i].mat)
		else
			achLobbyIcon:SetImage("vgui/hud/icon_locked")
		end
	end
	
	TabAchSheet:AddSheet("Lobby", PanelLobbyAch, nil)

	local PanelHL2Ach = vgui.Create( "DPanel", achFrame )
	PanelHL2Ach:SetSize(800, 850)
	PanelHL2Ach:SetPos(0, 400)
	PanelHL2Ach.Paint = function(s, w, h)
		draw.RoundedBox(0,0,0, w, h, Color(170, 170, 170, 255))
	end
	
	local ScrollHL2Ach = vgui.Create("DScrollPanel", PanelHL2Ach)
	ScrollHL2Ach:Dock(FILL)
	
	local iconListHL2 = vgui.Create("DIconLayout", ScrollHL2Ach)
	iconListHL2:Dock(FILL)
	iconListHL2:SetSpaceY(5)
	iconListHL2:SetSpaceX(5)
	
	for i = 1, #HL2_Ach_List do
		
		local hl2Panel = iconListHL2:Add("DPanel")
		hl2Panel:SetPaintBackground(false)
		hl2Panel:SetSize(128, 128)
		
		local achHL2Name = hl2Panel:Add("DLabel")
		achHL2Name:SetPos(0, 65)
		if table.HasValue(achievement, HL2_Ach_List[i].name) then
			achHL2Name:SetText(HL2_Ach_List[i].name)
		else
			achHL2Name:SetText("LOCKED")
		end
		achHL2Name:SizeToContents()
		achHL2Name:SetColor(Color(0, 0, 0))
		
		local achHL2Desc = hl2Panel:Add("DLabel")
		achHL2Desc:SetPos(0, 90)
		if table.HasValue(achievement, HL2_Ach_List[i].name) then
			achHL2Desc:SetText(HL2_Ach_List[i].desc)
		else
			achHL2Desc:SetText("???")
		end
		achHL2Desc:SizeToContents()
		achHL2Desc:SetColor(Color(0, 0, 0))
		
		local achHL2Icon = hl2Panel:Add("DImage")
		achHL2Icon:SetPos(0, 0)
		achHL2Icon:SetSize(64, 64)
		if table.HasValue(achievement, HL2_Ach_List[i].name) then
			achHL2Icon:SetImage(HL2_Ach_List[i].mat)
		else
			achHL2Icon:SetImage("vgui/hud/icon_locked")
		end
	end
	
	TabAchSheet:AddSheet("Half-Life 2", PanelHL2Ach, nil)
	
	local PanelMiscAch = vgui.Create( "DPanel", achFrame )
	PanelMiscAch:SetSize(800, 850)
	PanelMiscAch:SetPos(0, 400)
	PanelMiscAch.Paint = function(s, w, h)
		draw.RoundedBox(0,0,0, w, h, Color(170, 170, 170, 255))
	end
	
	local ScrollMiscAch = vgui.Create("DScrollPanel", PanelMiscAch)
	ScrollMiscAch:Dock(FILL)
	
	local iconListMisc = vgui.Create("DIconLayout", ScrollMiscAch)
	iconListMisc:Dock(FILL)
	iconListMisc:SetSpaceY(5)
	iconListMisc:SetSpaceX(5)
	
	for i = 1, #Misc_Ach_List do
		
		local miscPanel = iconListMisc:Add("DPanel")
		miscPanel:SetPaintBackground(false)
		miscPanel:SetSize(128, 128)
		
		local achMiscName = miscPanel:Add("DLabel")
		achMiscName:SetPos(0, 65)
		if table.HasValue(achievement, Misc_Ach_List[i].name) then
			achMiscName:SetText(Misc_Ach_List[i].name)
		else
			achMiscName:SetText("LOCKED")
		end
		
		achMiscName:SizeToContents()
		achMiscName:SetColor(Color(0, 0, 0))
		
		local achMiscDesc = miscPanel:Add("DLabel")
		achMiscDesc:SetPos(0, 90)
		if table.HasValue(achievement, Misc_Ach_List[i].name) then
			achMiscDesc:SetText(Misc_Ach_List[i].desc)
		else
			achMiscDesc:SetText("???")
		end
		achMiscDesc:SizeToContents()
		achMiscDesc:SetColor(Color(0, 0, 0))
		
		local achMiscIcon = miscPanel:Add("DImage")
		achMiscIcon:SetPos(0, 0)
		achMiscIcon:SetSize(64, 64)
		if table.HasValue(achievement, Misc_Ach_List[i].name) then
			achMiscIcon:SetImage(Misc_Ach_List[i].mat)
		else
			achMiscIcon:SetImage("vgui/hud/icon_locked")
		end
	end
		
	TabAchSheet:AddSheet("Miscellaneous", PanelMiscAch, nil)
	
	local PanelHL2Lambda = vgui.Create( "DPanel", achFrame )
	PanelHL2Lambda:SetSize(800, 850)
	PanelHL2Lambda:SetPos(0, 400)
	PanelHL2Lambda.Paint = function(s, w, h)
		draw.RoundedBox(0,0,0, w, h, Color(170, 170, 170, 255))
	end
		
	local ScrollHL2Lambda = vgui.Create("DScrollPanel", PanelHL2Lambda)
	ScrollHL2Lambda:Dock(FILL)
	
	local iconListHL2Lambda = vgui.Create("DIconLayout", ScrollHL2Lambda)
	iconListHL2Lambda:Dock(FILL)
	iconListHL2Lambda:SetSpaceY(5)
	iconListHL2Lambda:SetSpaceX(5)
	
	for i = 1, #HL2_Lambda_List do
		
		local lambdaHL2Panel = iconListHL2Lambda:Add("DPanel")
		lambdaHL2Panel:SetPaintBackground(false)
		lambdaHL2Panel:SetSize(128, 128)
		
		local lambdaHL2Name = lambdaHL2Panel:Add("DLabel")
		lambdaHL2Name:SetPos(0, 65)
		lambdaHL2Name:SetText(HL2_Lambda_List[i].name)
		
		lambdaHL2Name:SizeToContents()
		lambdaHL2Name:SetColor(Color(0, 0, 0))
		
		local lambdaHL2Icon = lambdaHL2Panel:Add("DImage")
		lambdaHL2Icon:SetPos(0, 0)
		lambdaHL2Icon:SetSize(64, 64)
		if table.HasValue(lambdas, HL2_Lambda_List[i].name) then
			lambdaHL2Icon:SetImage(HL2_Lambda_List[i].mat)
		else
			lambdaHL2Icon:SetImage("vgui/hud/icon_locked")
		end
	
	end
	
	TabAchSheet:AddSheet("HL2 Lambdas", PanelHL2Lambda, nil)
	
	local PanelHL2Vort = vgui.Create( "DPanel", achFrame )
	PanelHL2Vort:SetSize(800, 850)
	PanelHL2Vort:SetPos(0, 400)
	PanelHL2Vort.Paint = function(s, w, h)
		draw.RoundedBox(0,0,0, w, h, Color(170, 170, 170, 255))
	end
		
	local ScrollHL2Vort = vgui.Create("DScrollPanel", PanelHL2Vort)
	ScrollHL2Vort:Dock(FILL)
	
	local iconListHL2Vort = vgui.Create("DIconLayout", ScrollHL2Vort)
	iconListHL2Vort:Dock(FILL)
	iconListHL2Vort:SetSpaceY(5)
	iconListHL2Vort:SetSpaceX(5)
	
	for i = 1, #HL2_Vortex_List do
		
		local vortHL2Panel = iconListHL2Vort:Add("DPanel")
		vortHL2Panel:SetPaintBackground(false)
		vortHL2Panel:SetSize(128, 128)
		
		local vortHL2Name = vortHL2Panel:Add("DLabel")
		vortHL2Name:SetPos(0, 65)
		vortHL2Name:SetText(HL2_Vortex_List[i].name)
		
		vortHL2Name:SizeToContents()
		vortHL2Name:SetColor(Color(0, 0, 0))
		
		local vortHL2Icon = vortHL2Panel:Add("DImage")
		vortHL2Icon:SetPos(0, 0)
		vortHL2Icon:SetSize(64, 64)
		if table.HasValue(vortexes, HL2_Vortex_List[i].name) then
			vortHL2Icon:SetImage(HL2_Vortex_List[i].mat)
		else
			vortHL2Icon:SetImage("vgui/hud/icon_locked")
		end
	end
	
	TabAchSheet:AddSheet("HL2 Vortexes", PanelHL2Vort, nil)
end

surface.CreateFont( "DermaDefault_18px", {
	font = "DermaDefault",
	extended = false,
	size = 17,
	weight = 300,
	blursize = 0,
	scanlines = 0,
	antialias = false,
	underline = false,
	italic = false,
	strikeout = false,
	symbol = false,
	rotary = false,
	shadow = false,
	additive = false,
	outline = false
})

--Achievements popup
function PopUp()
	
	local achTitle = net.ReadString()
	local achImage = net.ReadString()
	local isRare = net.ReadBool()
	if not achTitle then achTitle = "Bug" end
	if not achImage then achImage = "entities/npc_kleiner.png" end
	
	local popUpNotify = vgui.Create("DNotify")
	popUpNotify:SetSize(320, 80)
	popUpNotify:SetPos(ScrW() - 280, ScrH())
	popUpNotify:SetLife(7)
	
	local popUpBG = vgui.Create("DPanel", popUpNotify)
	popUpBG:Dock(FILL)
	popUpBG:SetBackgroundColor(Color(200, 115, 0))
	
	local popUpImg = vgui.Create("DImage", popUpBG)
	popUpImg:SetPos(10, 10)
	popUpImg:SetSize(55, 55)
	popUpImg:SetImage(achImage)
	
	local popUplbl = vgui.Create("DLabel", popUpBG)
	popUplbl:SetPos(75, 5)
	popUplbl:SetSize(128, 72)
	popUplbl:SetText("Achievement Unlocked\n" .. achTitle)
	popUplbl:SetTextColor(Color(230, 230, 230))
	popUplbl:SetFont("DermaDefault_18px")
	popUplbl:SetWrap(true)
	
	popUpNotify:AddItem(popUpBG)
	
	popUpNotify:MoveTo(ScrW() - 280, ScrH() - 80, 2, 0, -1, function()
		timer.Simple(6, function()
			popUpNotify:MoveTo( ScrW(), - 280, ScrH(), 2, 0, -1, function() end)
		end)
	end)
	if not isRare then
		surface.PlaySound("hl2cr/ach_unlock.wav")
	else
		surface.PlaySound("hl2cr/rare_ach_unlock.wav")
	end
end

--Lambda and vortex popup
function PopUpSpecial()
	
	local specialTitle = net.ReadString()
	local specialImage = net.ReadString()
	if not specialTitle then achTitle = "Bug" end
	if not specialImage then specialImage = "entities/npc_kleiner.png" end
	
	local popUpNotify = vgui.Create("DNotify")
	popUpNotify:SetSize(320, 80)
	popUpNotify:SetPos(ScrW() - 280, ScrH())
	popUpNotify:SetLife(7)
	
	local popUpBG = vgui.Create("DPanel", popUpNotify)
	popUpBG:Dock(FILL)
	popUpBG:SetBackgroundColor(Color(200, 115, 0))
	
	local popUpImg = vgui.Create("DImage", popUpBG)
	popUpImg:SetPos(10, 10)
	popUpImg:SetSize(55, 55)
	popUpImg:SetImage(specialImage)
	
	local popUplbl = vgui.Create("DLabel", popUpBG)
	popUplbl:SetPos(75, 5)
	popUplbl:SetSize(128, 72)
	popUplbl:SetText("Special Unlocked\n" .. specialTitle)
	popUplbl:SetTextColor(Color(230, 230, 230))
	popUplbl:SetFont("DermaDefault_18px")
	popUplbl:SetWrap(true)
	
	popUpNotify:AddItem(popUpBG)
	
	popUpNotify:MoveTo(ScrW() - 280, ScrH() - 80, 2, 0, -1, function()
		timer.Simple(6, function()
			popUpNotify:MoveTo( ScrW(), - 280, ScrH(), 2, 0, -1, function() end)
		end)
	end)
	
	surface.PlaySound("hl1/fvox/blip.wav")
end

net.Receive("Open_Ach_Menu", function()
	local ach = net.ReadTable()
	local vort = net.ReadTable()
	local lamb = net.ReadTable()
	AchievementMenu(ach, vort, lamb)
end)

net.Receive("Achievement_Earned", PopUp)
net.Receive("Special_earned", PopUpSpecial)
