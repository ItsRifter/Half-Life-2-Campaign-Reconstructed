AchievementLists = {
	Lobby_Ach_List = {
		First_Time = {name = "First Time", mat = "vgui/achievements/hl2_beat_cemetery.png", reward = 0, isRare = false},
		Worthless_Secret = {name = "Worthless Secret", mat = "entities/npc_kleiner.png", reward = 0, isRare = true},
		Lost_Cause = {name = "Lost Cause", mat = "hl2cr/misc/lostcause", reward = 1000, isRare = false, clientTriggerable = true}
	},

	HL2_Ach_List = {
		A_Red_Letter_Baby = {name = "A Red Letter Baby", mat = "vgui/achievements/hl2_beat_game.png", reward = 2500, isRare = false},
		What_Cat = {name = "What Cat", mat = "vgui/achievements/hl2_beat_game.png", reward = 1000, isRare = false},
		Trusty_Hardware = {name = "Trusty Hardware", mat = "vgui/achievements/hl2_get_crowbar.png", reward = 500, isRare = false},
		ZeroPoint_Energy = {name = "ZeroPoint Energy", mat = "vgui/achievements/hl2_get_gravitygun.png", reward = 500, isRare = false},
		Rave_Ball = {name = "Rave Ball", desc = "Carry dog's ball through Ravenholm into the mines", mat = "vgui/achievements/hl2_get_gravitygun.png", reward = 10000, isRare = false},
		Keep_off_the_sand = {name = "Keep off the sand", mat = "vgui/achievements/hl2_beat_donttouchsand.png", reward = 7500, isRare = false},
		Finish_HL2 = {name = "Finish HL2", mat = "vgui/achievements/hl2_beat_game.png", reward = 2500, isRare = false},
		Lambda_Locator = {name = "Lambda Locator", mat = "vgui/achievements/hl2_find_alllambdas.png", reward = 15000, isRare = true},
		Flushed = {name = "Flushed", mat = "vgui/achievements/hl2_kill_enemy_withtoilet.png", reward = 2500, isRare = false},
		Blast_from_the_Past = {name = "Blast from the Past", mat = "vgui/achievements/hl2_find_hevfaceplate.png", reward = 2500, isRare = false},
		Vortex_Locator = {name = "Vortex Locator", mat = "vgui/achievements/hl2_find_alllambdas.png", reward = 30000, isRare = true},
		Crowbar_Only_HL2 = {name = "Crowbar Only HL2", mat = "vgui/achievements/hl2_beat_game.png", reward = 45000, isRare = false},
		Crowbar_Only_HL2_Hard = {name = "Crowbar Only HL2 Hard", mat = "vgui/achievements/hl2_beat_game.png", reward = 70000, isRare = false},
		Vorticough = {name = "Vorticough", mat = "vgui/achievements/hl2_find_vortigauntcave.png", reward = 2500, isRare = false},
		Lost_Coast = {name = "Lost Coast", mat = "vgui/achievements/hl2_beat_game.png", reward = 15000, isRare = true},
		Old_Friend = {name = "Old Friend", mat = "vgui/achievements/hl2_beat_game.png", reward = 10000, isRare = true},
		--Defiant = {name = "Defiant", mat = "vgui/achievements/hl2_hit_cancop_withcan.png", reward = 1000, isRare = false},
		--Submissive = {name = "Submissive", mat = "vgui/achievements/hl2_put_canintrash.png", reward = 1000, isRare = false},
	},

	EP1_Ach_List = {
		Containment = {name = "Containment", mat = "vgui/achievements/ep1_beat_citadelcore.png", reward = 1500, isRare = false},
		Watch_Your_Head = {name = "Watch your head!", mat = "vgui/achievements/ep1_beat_mainelevator.png", reward = 1500, isRare = false},
		Think_Fast = {name = "Think Fast!", mat = "vgui/achievements/hlx_kill_elitesoldier_withhisenergyball.png", reward = 3500, isRare = false},
		Pacifist = {name = "Pacifist", mat = "vgui/achievements/ep1_beat_citadelcore.png", reward = 5000, isRare = false},
		Safety_Measure = {name = "Safety Measure", mat = "vgui/achievements/ep1_beat_hospitalatticgunship.png", reward = 1000, isRare = false},
		Attica = {name = "Attica!", mat = "vgui/achievements/ep1_beat_hospitalatticgunship.png", reward = 1500, isRare = false},
		Finish_EP1 = {name = "Finish EP1", mat = "vgui/achievements/ep1_beat_game.png", reward = 2500, isRare = false},
		Crowbar_Only_EP1 = {name = "Crowbar Only EP1", mat = "vgui/achievements/ep1_beat_game.png", reward = 15000, isRare = false},
		Crowbar_Only_EP1_Hard = {name = "Crowbar Only EP1 Hard", mat = "vgui/achievements/ep1_beat_game.png", reward = 30000, isRare = false},
		Vortex_Locator_EP1 = {name = "Vortex Locator EP1", mat = "vgui/achievements/hl2_find_alllambdas.png", reward = 40000, isRare = true},
	},
	
	EP2_Ach_List = {
		Two_Birds_One_Stone = {name = "Two Birds One Stone", mat = "vgui/achievements/hl2_get_gravitygun.png", reward = 2000, isRare = false},
		Crowbar_Only_EP2 = {name = "Crowbar Only EP2", mat = "vgui/achievements/ep2_beat_missilesilo2.png", reward = 15000, isRare = false},
		Quiet_Mountain_Getaway = {name = "Quiet Mountain Getaway", mat = "vgui/achievements/ep2_beat_whiteforestinn.png", reward = 1000, isRare = false},
		Twofer = {name = "Twofer", mat = "vgui/achievements/ep2_beat_antlionguards.png", reward = 2000, isRare = false},
		Defense_of_the_Armament = {name = "Defense of the Armament", mat = "vgui/achievements/ep2_beat_missilesilo2.png", reward = 5000, isRare = false},
		Finish_EP2 = {name = "Finish EP2", mat = "vgui/achievements/hlx_find_onegman.png", reward = 3000, isRare = false},
		Vortex_Locator_EP2 = {name = "Vortex Locator EP2", mat = "vgui/achievements/hl2_find_alllambdas.png", reward = 50000, isRare = true},
		Crowbar_Only_EP2 = {name = "Crowbar Only EP2", mat = "vgui/achievements/ep2_beat_missilesilo2.png", reward = 60000, isRare = true},
	},

	Misc_Ach_List = {
		Survival_Lost = {name = "A Predictable Failure", mat = "vgui/achievements/hl2_find_allgmen.png", reward = 1500, isRare = false},
		Blast_that_little = {name = "Blast that little", mat = "vgui/achievements/hl2_beat_toxictunnel.png", reward = 2500, isRare = false, clientTriggerable = true},
		Fast_Climber = {name = "Fast Climber", mat = "vgui/achievements/hl2_beat_toxictunnel.png", reward = 5000, isRare = false, clientTriggerable = true},
		One_True_Freeman = {name = "One True Freeman", mat = "vgui/achievements/hl2_get_crowbar.png", reward = 500000, isRare = true},
		Ultimate_One_True_Freeman = {name = "Ultimate One True Freeman", mat = "vgui/achievements/hl2_get_crowbar.png", reward = 1000000, isRare = true},
	},
	
	Kill_Ach_List = {
		Crowbar_Killer_250 = {name = "Crowbar Killer I", mat = "vgui/achievements/hl2_get_crowbar.png", reward = 5000, isRare = false},
		Crowbar_Killer_500 = {name = "Crowbar Killer II", mat = "vgui/achievements/hl2_get_crowbar.png", reward = 10000, isRare = false},
		Crowbar_Killer_1000 = {name = "Crowbar Killer III", mat = "vgui/achievements/hl2_get_crowbar.png", reward = 20000, isRare = false},
	},
	
	Event_Ach_List = {
		Candy_Collector = {name = "Candy Collector", mat = "vgui/achievements/hl2_find_allgmen.png", reward = 10000, isRare = false},
	}
}

SpecialLists = {
	HL2_Lambda = {
		d1_trainstation_05 = {name = "d1_trainstation_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_01 = {name = "d1_canals_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_01a = {name = "d1_canals_01a", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_02 = {name = "d1_canals_02", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_03 = {name = "d1_canals_03", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_05 = {name = "d1_canals_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_06 = {name = "d1_canals_06", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_07 = {name = "d1_canals_07", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_08 = {name = "d1_canals_08", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_09 = {name = "d1_canals_09", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_10 = {name = "d1_canals_10", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_canals_12 = {name = "d1_canals_12", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_eli_01 = {name = "d1_eli_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_town_01 = {name = "d1_town_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_town_01a = {name = "d1_town_01a", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d1_town_05 = {name = "d1_town_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_01 = {name = "d2_coast_01", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_03 = {name = "d2_coast_03", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_04 = {name = "d2_coast_04", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_05 = {name = "d2_coast_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_07 = {name = "d2_coast_07", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_09 = {name = "d2_coast_09", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_coast_11 = {name = "d2_coast_11", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_prison_02 = {name = "d2_prison_02", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_prison_03 = {name = "d2_prison_03", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_prison_05 = {name = "d2_prison_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d2_prison_06 = {name = "d2_prison_06", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_02 = {name = "d3_c17_02", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_04 = {name = "d3_c17_04", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_05 = {name = "d3_c17_05", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_06a = {name = "d3_c17_06a", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_06b = {name = "d3_c17_06b", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_08 = {name = "d3_c17_08", mat = "vgui/achievements/hl2_find_alllambdas.png"},
		d3_c17_12b = {name = "d3_c17_12b", mat = "vgui/achievements/hl2_find_alllambdas.png"},
	},
	
	HL2_Vortex = {
		d1_trainstation_05 = {name = "d1_trainstation_05", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_trainstation_06 = {name = "d1_trainstation_06", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_canals_01 = {name = "d1_canals_01", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_canals_02 = {name = "d1_canals_02", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_canals_05 = {name = "d1_canals_05", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_canals_07 = {name = "d1_canals_07", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_canals_08 = {name = "d1_canals_08", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_canals_09 = {name = "d1_canals_09", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_eli_01 = {name = "d1_eli_01", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_eli_02 = {name = "d1_eli_02", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_town_02 = {name = "d1_town_02", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_town_03 = {name = "d1_town_03", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_town_02a = {name = "d1_town_02a", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_town_04 = {name = "d1_town_04", mat = "vgui/achievements/hlx_find_onegman.png"},
		d1_town_05 = {name = "d1_town_05", mat = "vgui/achievements/hlx_find_onegman.png"},
		d2_coast_01 = {name = "d2_coast_01", mat = "vgui/achievements/hlx_find_onegman.png"},
		d2_coast_04 = {name = "d2_coast_04", mat = "vgui/achievements/hlx_find_onegman.png"},
		d2_coast_08 = {name = "d2_coast_08", mat = "vgui/achievements/hlx_find_onegman.png"},
		d2_coast_11 = {name = "d2_coast_11", mat = "vgui/achievements/hlx_find_onegman.png"},
		d2_prison_07 = {name = "d2_prison_07", mat = "vgui/achievements/hlx_find_onegman.png"},
		d3_c17_03 = {name = "d3_c17_03", mat = "vgui/achievements/hlx_find_onegman.png"},
		d3_c17_07 = {name = "d3_c17_07", mat = "vgui/achievements/hlx_find_onegman.png"},
		d3_c17_12b = {name = "d3_c17_12b", mat = "vgui/achievements/hlx_find_onegman.png"},
		d3_c17_13 = {name = "d3_c17_13", mat = "vgui/achievements/hlx_find_onegman.png"}
	},
	
	EP1_Vortex = {
		ep1_citadel_01 = {name = "ep1_citadel_01", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep1_citadel_02 = {name = "ep1_citadel_02", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep1_c17_01 = {name = "ep1_c17_01", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep1_c17_02 = {name = "ep1_c17_02", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep1_c17_02b = {name = "ep1_c17_02b", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep1_c17_06 = {name = "ep1_c17_06", mat = "vgui/achievements/hlx_find_onegman.png"}
	},
	
	EP2_Vortex = {
		ep2_outland_01 = {name = "ep2_outland_01", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_01a = {name = "ep2_outland_01a", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_04 = {name = "ep2_outland_04", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_05 = {name = "ep2_outland_05", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_06 = {name = "ep2_outland_06", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_07 = {name = "ep2_outland_07", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_10 = {name = "ep2_outland_10", mat = "vgui/achievements/hlx_find_onegman.png"},
		ep2_outland_12a = {name = "ep2_outland_12a", mat = "vgui/achievements/hlx_find_onegman.png"},
	}
}

function Achievement(ply, name, list, clientTriggered)
	if not ply then return end
	-- Get achievement list, or exit if it doesn't exists
	local achievementList = AchievementLists[list]
	if not achievementList then return end

	-- Get achievement, or exit if it doesn't exists
	local achievement = achievementList[name]
	if not achievement then return end

	--Get the achievement rewards
	local rewards = achievementList[name].reward
	if not rewards then return end
	
	-- Only allow the client to trigger achievements that are "clientTriggerable"
	if clientTriggered and not achievement.clientTriggerable then return end

	-- Check if the player already got the achievement
	if table.HasValue(ply.hl2cPersistent.Achievements, name) then return end

	-- Give achievement to player
	table.insert(ply.hl2cPersistent.Achievements, name)

	-- Send space separated achievement list to client
	ply:SetNWString("Ach", table.concat(ply.hl2cPersistent.Achievements, " "))

	-- Trigger "achievement earned" notification on client
	net.Start("Achievement_Earned")
		net.WriteString(achievement.name)
		net.WriteString(achievement.mat)
		net.WriteBool(achievement.isRare)
	net.Send(ply)

	-- Make everyone proud of ply
	for k, v in pairs(player.GetAll()) do
		if achievement.isRare then
			v:ChatPrint(string.format("Congratulations to %s as they earned a rare achievement!: %s", ply:Nick(), achievement.name))
		else
			v:ChatPrint(string.format("%s has earned the achievement: %s", ply:Nick(), achievement.name))
		end
	end

	-- XP stuff
	if rewards ~= 0 then
		AddXP(ply, rewards)
		ply:ChatPrint(string.format("You got %s XP", rewards))
	end
end

function Special(ply, name, list, amt)
	-- Get special list, or exit if it doesn't exists
	local specialList = SpecialLists[list]
	if not specialList then return end

	-- Get special, or exit if it doesn't exists
	local special = specialList[name]
	if not special then return end
	
	net.Start("Special_Earned")
		net.WriteString(special.name)
		net.WriteString(special.mat)
	net.Send(ply)
	
	if amt ~= 0 then
		AddXP(ply, amt)
		ply:ChatPrint(string.format("You got %s XP", amt))
	end
end

net.Receive("Achievement", function(len, ply)
	local name = net.ReadString()
	local listName = net.ReadString()
	local amt = net.ReadInt(32)
	Achievement(ply, name, listName, amt)
end)


